<template>
  <div class="chat-list">
    <q-toolbar
      class="toolbar"
      color="chat">
      <q-toolbar-title style="padding: 0px">
        <!--<q-search
          color="chat"
          inverted
          v-model="searchModel"
          :debounce="600"
          placeholder="Find user"
          icon="search"
        />-->
      </q-toolbar-title>
      <router-link
        v-if="showExpand"
        :to="{name: 'chat'}">
        <q-btn
          flat
          small
          :disabled="$route.name === 'chat' || $route.name === 'chatDetail'"
        >
          <i
            class="fa fa-expand"
          />
        </q-btn>
      </router-link>
    </q-toolbar>
    <q-list
      highlight
      v-if="data"
      class="no-border">
      <q-item
        style="cursor: pointer"
        v-for="item in [1, 2, 3, 4, 5]"
        @click="openFloater ? $emit('addFloater', item) : ''"
        :to="openFloater ? '' : {name: 'chatDetail', params: {userId: item}}"
        :key="item">
        <q-item-side>
          <ProfilePicture
            :user="{ displayName: 'Max Mustermann', id: 2 }"
            :size="24"
          />
        </q-item-side>
        <q-item-main
          v-if="data && data.messages && data.messages[0]"
          class="one-lined"
          :label="data.messages[0].author.displayName"
          :sublabel="data.messages[0].content" />
        <q-item-side right>
          <small>10min</small>
        </q-item-side>
      </q-item>
    </q-list>
    <q-list v-else>
      <q-item>
        <q-item-main
          class="multi-lined"
          label="No data"
          sublabel="You will have to click on GroupWall for now to see something" />
      </q-item>
    </q-list>
  </div>
</template>

<script>
import { QList, QSearch, QToolbar, QBtn, QToolbarTitle, QItem, QItemMain, QItemSide } from 'quasar'
import ProfilePicture from '@/components/ProfilePictures/ProfilePicture'

export default {
  name: 'ChatListUI',
  components: { ProfilePicture, QSearch, QToolbar, QToolbarTitle, QList, QBtn, QItem, QItemMain, QItemSide },
  props: {
    data: {
      type: Object,
      required: true,
    },
    showExpand: {
      type: Boolean,
      default: false,
    },
  },
  computed: {
    openFloater () {
      return this.$q.platform.is.desktop && this.$route.name !== 'chat' && this.$route.name !== 'chatDetail'
    },
  },
}
</script>

<style scoped lang="stylus">
.chat-list
  .toolbar
    min-height 40px
    height 40px
  min-width 200px
  .q-list
    padding-top 0
  .q-search
    background rgba(0,0,0,0)
    border 0
  .q-search.q-if-focused
    background rgba(0,0,0,0.35)
</style>

<style lang="stylus">
.chat-list .one-lined .q-item-sublabel
  overflow hidden
  display block !important
  white-space nowrap
  text-overflow ellipsis
</style>
